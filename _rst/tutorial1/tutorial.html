<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Tutorial 1: Physics Informed Neural Networks on PINA &mdash; PINA 0.0.3 documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Tutorial 2: resolution of Poisson problem and usage of extra-features" href="../tutorial2/tutorial.html" />
    <link rel="prev" title="License" href="../../LICENSE.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            PINA
          </a>
              <div class="version">
                0.0.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Package Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../LICENSE.html">License</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Getting start with PINA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pina-problem">1.1. PINA Problem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#initialize-the-problem-class">1.1.1. Initialize the Problem class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#write-the-problem-class">1.1.2. Write the problem class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#build-pinn-object">1.2. Build PINN object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sample-points-in-the-domain">1.3. Sample points in the domain</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#very-simple-training-and-plotting">1.3.1. Very simple training and plotting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial2/tutorial.html">2. Poisson problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial3/tutorial.html">3. Wave equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial4/tutorial.html">4. Continuous Convolutional Filter</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PINA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">1. </span>Tutorial 1: Physics Informed Neural Networks on PINA</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/_rst/tutorial1/tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="tutorial-1-physics-informed-neural-networks-on-pina">
<h1><span class="section-number">1. </span>Tutorial 1: Physics Informed Neural Networks on PINA<a class="headerlink" href="#tutorial-1-physics-informed-neural-networks-on-pina" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial we will show the typical use case of PINA on a toy
problem. Specifically, the tutorial aims to introduce the following
topics:</p>
<ul class="simple">
<li><p>Defining a PINA Problem,</p></li>
<li><p>Build a <code class="docutils literal notranslate"><span class="pre">pinn</span></code> object,</p></li>
<li><p>Sample points in the domain.</p></li>
</ul>
<p>These are the three main steps needed <strong>before</strong> training a Physics
Informed Neural Network (PINN). We will show in detailed each step, and
at the end we will solve a very simple problem with PINA.</p>
<div class="section" id="pina-problem">
<h2><span class="section-number">1.1. </span>PINA Problem<a class="headerlink" href="#pina-problem" title="Permalink to this headline">¶</a></h2>
<div class="section" id="initialize-the-problem-class">
<h3><span class="section-number">1.1.1. </span>Initialize the Problem class<a class="headerlink" href="#initialize-the-problem-class" title="Permalink to this headline">¶</a></h3>
<p>The problem definition in the PINA framework is done by building a
phython <code class="docutils literal notranslate"><span class="pre">class</span></code>, inherited from one or more problem classes
(<code class="docutils literal notranslate"><span class="pre">SpatialProblem</span></code>, <code class="docutils literal notranslate"><span class="pre">TimeDependentProblem</span></code>, <code class="docutils literal notranslate"><span class="pre">ParametricProblem</span></code>),
depending on the nature of the problem treated. Let’s see an example to
better understand: #### Simple Ordinary Differential Equation Consider
the following:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\begin{cases}
\frac{d}{dx}u(x) &amp;=  u(x) \quad x\in(0,1)\\
u(x=0) &amp;= 1 \\
\end{cases}
\end{equation}\end{split}\]</div>
<p>with analytical solution <span class="math notranslate nohighlight">\(u(x) = e^x\)</span>. In this case we have that
our ODE depends only on the spatial variable <span class="math notranslate nohighlight">\(x\in(0,1)\)</span> , this
means that our problem class is going to be inherited from
<code class="docutils literal notranslate"><span class="pre">SpatialProblem</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pina.problem</span> <span class="kn">import</span> <span class="n">SpatialProblem</span>
<span class="kn">from</span> <span class="nn">pina</span> <span class="kn">import</span> <span class="n">Span</span>

<span class="k">class</span> <span class="nc">SimpleODE</span><span class="p">(</span><span class="n">SpatialProblem</span><span class="p">):</span>

    <span class="n">output_variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">]</span>
    <span class="n">spatial_domain</span> <span class="o">=</span> <span class="n">Span</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>

    <span class="c1"># other stuff ...</span>
</pre></div>
</div>
<p>Notice that we define <code class="docutils literal notranslate"><span class="pre">output_variables</span></code> as a list of symbols,
indicating the output variables of our equation (in this case only
<span class="math notranslate nohighlight">\(u\)</span>). The <code class="docutils literal notranslate"><span class="pre">spatial_domain</span></code> variable indicates where the sample
points are going to be sampled in the domain, in this case
<span class="math notranslate nohighlight">\(x\in(0,1)\)</span>.</p>
<p>What about if we also have a time depencency in the equation? Well in
that case our <code class="docutils literal notranslate"><span class="pre">class</span></code> will inherit from both <code class="docutils literal notranslate"><span class="pre">SpatialProblem</span></code> and
<code class="docutils literal notranslate"><span class="pre">TimeDependentProblem</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pina.problem</span> <span class="kn">import</span> <span class="n">SpatialProblem</span><span class="p">,</span> <span class="n">TimeDependentProblem</span>
<span class="kn">from</span> <span class="nn">pina</span> <span class="kn">import</span> <span class="n">Span</span>

<span class="k">class</span> <span class="nc">TimeSpaceODE</span><span class="p">(</span><span class="n">SpatialProblem</span><span class="p">,</span> <span class="n">TimeDependentProblem</span><span class="p">):</span>

    <span class="n">output_variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">]</span>
    <span class="n">spatial_domain</span> <span class="o">=</span> <span class="n">Span</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
    <span class="n">temporal_domain</span> <span class="o">=</span> <span class="n">Span</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>

    <span class="c1"># other stuff ...</span>
</pre></div>
</div>
<p>where we have included the <code class="docutils literal notranslate"><span class="pre">temporal_domain</span></code> variable indicating the
time domain where we want the solution.</p>
<p>Summarizing, in PINA we can initialize a problem with a class which is
inherited from three base classes: <code class="docutils literal notranslate"><span class="pre">SpatialProblem</span></code>,
<code class="docutils literal notranslate"><span class="pre">TimeDependentProblem</span></code>, <code class="docutils literal notranslate"><span class="pre">ParametricProblem</span></code>, depending on the type
of problem we are considering. For reference:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SpatialProblem</span></code> <span class="math notranslate nohighlight">\(\rightarrow\)</span> spatial variable(s) presented in the differential equation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TimeDependentProblem</span></code> <span class="math notranslate nohighlight">\(\rightarrow\)</span> time variable(s) presented in the differential equation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ParametricProblem</span></code> <span class="math notranslate nohighlight">\(\rightarrow\)</span> parameter(s) presented in the differential equation</p></li>
</ul>
</div>
<div class="section" id="write-the-problem-class">
<h3><span class="section-number">1.1.2. </span>Write the problem class<a class="headerlink" href="#write-the-problem-class" title="Permalink to this headline">¶</a></h3>
<p>Once the problem class is initialized we need to write the differential
equation in PINA language. For doing this we need to load the pina
operators found in <code class="docutils literal notranslate"><span class="pre">pina.operators</span></code> module. Let’s again consider the
Equation (1) and try to write the PINA model class:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from pina.problem import SpatialProblem
from pina.operators import grad
from pina import Condition, Span

import torch


class SimpleODE(SpatialProblem):

    output_variables = [&#39;u&#39;]
    spatial_domain = Span({&#39;x&#39;: [0, 1]})

    # defining the ode equation
    def ode_equation(input_, output_):

        # computing the derivative
        u_x = grad(output_, input_, components=[&#39;u&#39;], d=[&#39;x&#39;])

        # extracting u input variable
        u = output_.extract([&#39;u&#39;])

        # calculate residual and return it
        return u_x - u

    # defining initial condition
    def initial_condition(input_, output_):

        # setting initial value
        value = 1.0

        # extracting u input variable
        u = output_.extract([&#39;u&#39;])

        # calculate residual and return it
        return u - value

    # Conditions to hold
    conditions = {
        &#39;x0&#39;: Condition(location=Span({&#39;x&#39;: 0.}), function=initial_condition),
        &#39;D&#39;: Condition(location=Span({&#39;x&#39;: [0, 1]}), function=ode_equation),
    }

    # defining true solution
    def truth_solution(self, pts):
        return torch.exp(pts.extract([&#39;x&#39;]))
</pre></div>
</div>
<p>After the defition of the Class we need to write different class
methods, where each method is a function returning a residual. This
functions are the ones minimized during the PINN optimization, for the
different conditions. For example, in the domain <span class="math notranslate nohighlight">\((0,1)\)</span> the ODE
equation (<code class="docutils literal notranslate"><span class="pre">ode_equation</span></code>) must be satisfied, so we write it by putting
all the ODE equation on the right hand side, such that we return the
zero residual. This is done for all the conditions (<code class="docutils literal notranslate"><span class="pre">ode_equation</span></code>,
<code class="docutils literal notranslate"><span class="pre">initial_condition</span></code>).</p>
<p>Once we have defined the function we need to tell the network where
these methods have to be applied. For doing this we use the class
<code class="docutils literal notranslate"><span class="pre">Condition</span></code>. In <code class="docutils literal notranslate"><span class="pre">Condition</span></code> we pass the location points and the
function to be minimized on those points (other possibilities are
allowed, see the documentation for reference).</p>
<p>Finally, it’s possible to defing the <code class="docutils literal notranslate"><span class="pre">truth_solution</span></code> function, which
can be useful if we want to plot the results and see a comparison of
real vs expected solution. Notice that <code class="docutils literal notranslate"><span class="pre">truth_solution</span></code> function is a
method of the <code class="docutils literal notranslate"><span class="pre">PINN</span></code> class, but it is not mandatory for the problem
definition.</p>
</div>
</div>
<div class="section" id="build-pinn-object">
<h2><span class="section-number">1.2. </span>Build PINN object<a class="headerlink" href="#build-pinn-object" title="Permalink to this headline">¶</a></h2>
<p>The basics requirements for building a PINN model are a problem and a
model. We have already covered the problem definition. For the model one
can use the default models provided in PINA or use a custom model. We
will not go into the details of model definition, Tutorial2 and
Tutorial3 treat the topic in detail.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from pina.model import FeedForward
from pina import PINN

# initialize the problem
problem = SimpleODE()

# build the model
model = FeedForward(
    layers=[10, 10],
    func=torch.nn.Tanh,
    output_variables=problem.output_variables,
    input_variables=problem.input_variables
)

# create the PINN object
pinn = PINN(problem, model)
</pre></div>
</div>
<p>Creating the pinn object is fairly simple by using the <code class="docutils literal notranslate"><span class="pre">PINN</span></code> class,
different optional inputs can be passed: optimizer, batch size, … (see
<a class="reference external" href="https://mathlab.github.io/PINA/">documentation</a> for reference).</p>
</div>
<div class="section" id="sample-points-in-the-domain">
<h2><span class="section-number">1.3. </span>Sample points in the domain<a class="headerlink" href="#sample-points-in-the-domain" title="Permalink to this headline">¶</a></h2>
<p>Once the <code class="docutils literal notranslate"><span class="pre">pinn</span></code> object is created, we need to generate the points for
starting the optimization. For doing this we use the <code class="docutils literal notranslate"><span class="pre">span_pts</span></code> method
of the <code class="docutils literal notranslate"><span class="pre">PINN</span></code> class. Let’s see some methods to sample in
<span class="math notranslate nohighlight">\((0,1 )\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># sampling 20 points in (0, 1) with discrite step
pinn.span_pts(20, &#39;grid&#39;, locations=[&#39;D&#39;])

# sampling 20 points in (0, 1) with latin hypercube
pinn.span_pts(20, &#39;latin&#39;, locations=[&#39;D&#39;])

# sampling 20 points in (0, 1) randomly
pinn.span_pts(20, &#39;random&#39;, locations=[&#39;D&#39;])
</pre></div>
</div>
<p>We can also use a dictionary for specific variables:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pinn.span_pts({&#39;variables&#39;: [&#39;x&#39;], &#39;mode&#39;: &#39;grid&#39;, &#39;n&#39;: 20}, locations=[&#39;D&#39;])
</pre></div>
</div>
<p>We are going to use equispaced points for sampling. We need to sample in
all the conditions domains. In our case we sample in <code class="docutils literal notranslate"><span class="pre">D</span></code> and <code class="docutils literal notranslate"><span class="pre">x0</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># sampling for training
pinn.span_pts(1, &#39;random&#39;, locations=[&#39;x0&#39;])
pinn.span_pts(20, &#39;grid&#39;, locations=[&#39;D&#39;])
</pre></div>
</div>
<div class="section" id="very-simple-training-and-plotting">
<h3><span class="section-number">1.3.1. </span>Very simple training and plotting<a class="headerlink" href="#very-simple-training-and-plotting" title="Permalink to this headline">¶</a></h3>
<p>Once we have defined the PINA model, created a network and sampled
points in the domain, we have everything that is necessary for training
a PINN. Here we show a very short training and some method for plotting
the results.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># simple training
final_loss = pinn.train(stop=3000, frequency_print=1000)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>              <span class="nb">sum</span>          <span class="n">x0initial_co</span> <span class="n">Dode_equatio</span>
<span class="p">[</span><span class="n">epoch</span> <span class="mi">00000</span><span class="p">]</span> <span class="mf">1.933187e+00</span> <span class="mf">1.825489e+00</span> <span class="mf">1.076983e-01</span>
              <span class="nb">sum</span>          <span class="n">x0initial_co</span> <span class="n">Dode_equatio</span>
<span class="p">[</span><span class="n">epoch</span> <span class="mi">00001</span><span class="p">]</span> <span class="mf">1.860870e+00</span> <span class="mf">1.766795e+00</span> <span class="mf">9.407549e-02</span>
              <span class="nb">sum</span>          <span class="n">x0initial_co</span> <span class="n">Dode_equatio</span>
<span class="p">[</span><span class="n">epoch</span> <span class="mi">01000</span><span class="p">]</span> <span class="mf">4.974120e-02</span> <span class="mf">1.635524e-02</span> <span class="mf">3.338596e-02</span>
              <span class="nb">sum</span>          <span class="n">x0initial_co</span> <span class="n">Dode_equatio</span>
<span class="p">[</span><span class="n">epoch</span> <span class="mi">02000</span><span class="p">]</span> <span class="mf">1.099083e-03</span> <span class="mf">3.420736e-05</span> <span class="mf">1.064875e-03</span>
<span class="p">[</span><span class="n">epoch</span> <span class="mi">03000</span><span class="p">]</span> <span class="mf">4.049759e-04</span> <span class="mf">2.937766e-06</span> <span class="mf">4.020381e-04</span>
</pre></div>
</div>
<p>After the training we have saved the final loss in <code class="docutils literal notranslate"><span class="pre">final_loss</span></code>, which
we can inspect. By default PINA uses mean square error loss.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># inspecting final loss
final_loss
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.0004049759008921683</span>
</pre></div>
</div>
<p>By using the <code class="docutils literal notranslate"><span class="pre">Plotter</span></code> class from PINA we can also do some quatitative
plots of the loss function.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from pina.plotter import Plotter

# plotting the loss
plotter = Plotter()
plotter.plot_loss(pinn)
</pre></div>
</div>
<img alt="../../_images/tutorial_25_0.png" src="../../_images/tutorial_25_0.png" />
<p>We have a very smooth loss decreasing!</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../LICENSE.html" class="btn btn-neutral float-left" title="License" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tutorial2/tutorial.html" class="btn btn-neutral float-right" title="2. Tutorial 2: resolution of Poisson problem and usage of extra-features" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright 2021-2021, PINA contributors.
      <span class="lastupdated">Last updated on Jul 04, 2023.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>